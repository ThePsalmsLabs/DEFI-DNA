# ============================================
# DEFI DNA BACKEND - PRODUCTION ENVIRONMENT
# ============================================
#
# INSTRUCTIONS:
# 1. Copy this file to .env.production
# 2. Fill in all values below
# 3. NEVER commit .env.production to git!
# 4. Use environment-specific values for each deployment
#
# Last Updated: January 21, 2026

# ============================================
# DATABASE CONFIGURATION
# ============================================

DB_HOST=your_production_db_host
DB_PORT=5432
DB_NAME=defidna_production
DB_USER=defidna_user
DB_PASSWORD=your_secure_password_here

# Optional: Connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_IDLE_TIMEOUT=30000
DB_CONNECTION_TIMEOUT=2000

# ============================================
# BLOCKCHAIN CONFIGURATION
# ============================================

# Network: Base Mainnet = 8453, Base Sepolia = 84532
CHAIN_ID=8453

# RPC URL - Using Alchemy endpoint from foundry.toml
RPC_URL_BASE=https://base-mainnet.g.alchemy.com/v2/f_SNCtMgIYAJswII3Y2BkjcSAWMpfNTh

# Alternative: Base Sepolia for testnet
# CHAIN_ID=84532
# RPC_URL_BASE_SEPOLIA=https://base-sepolia.g.alchemy.com/v2/f_SNCtMgIYAJswII3Y2BkjcSAWMpfNTh

# ============================================
# SMART CONTRACT ADDRESSES
# ============================================
# UPDATE THESE AFTER DEPLOYING CONTRACTS!

# DNASubscriber contract address (Base Mainnet - deployed)
DNA_SUBSCRIBER_ADDRESS=0xeac0cccaf338264f74d6bb7e033a24df8b201884

# DNAReader contract address (Base Mainnet - deployed)
DNA_READER_ADDRESS=0x4a870f11df9677d73862c384258cecf4247e094d

# AdvancedPositionManager contract address (Base Mainnet - deployed)
ADVANCED_POSITION_MANAGER_ADDRESS=0xe1d264209e4ed85219ef10b6fa1b26dde2b7273c

# ============================================
# EXTERNAL API KEYS
# ============================================

# CoinGecko API Key (for price feed service)
# Get from: https://www.coingecko.com/en/api/pricing
# Free tier: 10-50 calls/minute
# Pro tier: Recommended for production
COINGECKO_API_KEY=your_coingecko_api_key_here

# The Graph API Key (for historical Uniswap V2/V3 data)
# Get from: https://thegraph.com/studio/apikeys/
# Required for full analytics features
GRAPH_API_KEY=your_graph_api_key_here

# Optional: Alchemy API Key (if you want to use your own)
# ALCHEMY_API_KEY=your_alchemy_api_key_here

# Optional: BaseScan API Key (for contract verification)
# BASESCAN_API_KEY=your_basescan_api_key_here

# ============================================
# SERVER CONFIGURATION
# ============================================

# Server port
PORT=4000

# Node environment
NODE_ENV=production

# Frontend URL for CORS
FRONTEND_URL=https://defidna.com

# Optional: Additional allowed origins (comma-separated)
# ALLOWED_ORIGINS=https://app.defidna.com,https://www.defidna.com

# API Rate Limiting
RATE_LIMIT_WINDOW=15 # minutes
RATE_LIMIT_MAX=100 # requests per window

# ============================================
# FEATURE FLAGS
# ============================================

# Enable event indexer (set to 'true' to start indexing blockchain events)
ENABLE_INDEXER=true

# Enable background cron jobs (daily snapshots, score recalculation)
ENABLE_CRON_JOBS=true

# Enable WebSocket server for real-time updates
ENABLE_WEBSOCKET=true

# ============================================
# LOGGING & MONITORING
# ============================================

# Log level: error, warn, info, debug
LOG_LEVEL=info

# Optional: Sentry DSN for error tracking
# SENTRY_DSN=https://...@sentry.io/...

# Optional: DataDog API Key for monitoring
# DATADOG_API_KEY=your_datadog_api_key

# ============================================
# INDEXER CONFIGURATION
# ============================================

# Block to start indexing from (0 = from genesis, or specify a recent block)
START_BLOCK=0

# Batch size for processing events
INDEXER_BATCH_SIZE=1000

# Polling interval in milliseconds
INDEXER_POLL_INTERVAL=12000

# Maximum blocks to process per batch
INDEXER_MAX_BLOCKS_PER_BATCH=1000

# ============================================
# CRON JOB SCHEDULE
# ============================================

# Daily snapshot cron (default: every day at 00:00 UTC)
DAILY_SNAPSHOT_CRON=0 0 * * *

# Score recalculation cron (default: every hour)
SCORE_RECALC_CRON=0 * * * *

# ============================================
# SECURITY
# ============================================

# JWT Secret (generate with: openssl rand -base64 32)
# Only needed if implementing authentication
# JWT_SECRET=your_random_jwt_secret_here

# API Key for admin endpoints (optional)
# ADMIN_API_KEY=your_random_admin_key_here

# ============================================
# WEBSOCKET CONFIGURATION
# ============================================

# WebSocket heartbeat interval (ms)
WS_HEARTBEAT_INTERVAL=30000

# WebSocket connection timeout (ms)
WS_CONNECTION_TIMEOUT=60000

# Maximum concurrent WebSocket connections
WS_MAX_CONNECTIONS=1000

# ============================================
# PERFORMANCE TUNING
# ============================================

# Query timeout (ms)
QUERY_TIMEOUT=30000

# Cache TTL for API responses (seconds)
CACHE_TTL=60

# Enable response compression
ENABLE_COMPRESSION=true

# ============================================
# BACKUP & RECOVERY
# ============================================

# Database backup cron (optional)
# DB_BACKUP_CRON=0 2 * * *

# Backup retention days
# DB_BACKUP_RETENTION_DAYS=30

# ============================================
# HEALTH CHECKS
# ============================================

# Health check endpoint
HEALTH_CHECK_PATH=/health

# Ready check endpoint
READY_CHECK_PATH=/ready

# ============================================
# DEVELOPMENT / STAGING OVERRIDES
# ============================================
# Uncomment for staging environment

# NODE_ENV=staging
# PORT=4001
# FRONTEND_URL=https://staging.defidna.com
# LOG_LEVEL=debug

# ============================================
# PRODUCTION CHECKLIST
# ============================================
#
# Before deploying to production, ensure:
# [x] All contract addresses are updated
# [x] CoinGecko API key is set (Pro tier recommended)
# [x] The Graph API key is set
# [x] Database is configured with proper backups
# [x] FRONTEND_URL matches your actual domain
# [x] LOG_LEVEL is set to 'info' or 'warn'
# [x] All sensitive values are unique and secure
# [x] Rate limiting is configured appropriately
# [x] Monitoring is set up (Sentry, DataDog, etc.)
# [x] Health checks are configured
# [x] SSL/TLS certificates are valid
# [x] Firewall rules are in place
# [x] This file is NOT committed to git
#
# ============================================
